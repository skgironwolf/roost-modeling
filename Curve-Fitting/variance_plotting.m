%load('roostdev.mat');
%load('roostdev_smoothed.mat');
%load('roostdev_smoothed2.mat');
load('roostdev_withCutoff.mat');

figure(1);
 r = r(v < 1E8);
 v = v(v < 1E8);

%**************%
%finding 'r^2'
p = polyfit(r,v,1);
%p(1) is the slope and p(2) is the intercept of the linear predictor. You can also obtain regression coefficients using the Basic Fitting UI.
%Call polyval to use p to predict y, calling the result yfit:
yfit = polyval(p,r);
%Compute the residual values as a vector of signed numbers:
yresid = v - yfit;
%Square the residuals and total them to obtain the residual sum of squares:
SSresid = sum(yresid.^2);
%Compute the total sum of squares of y by multiplying the variance of y by the number of observations minus 1:
SStotal = (length(v)-1) * var(v);
%Compute R2
rsq = 1 - SSresid/SStotal;

plot(r,v, 'Marker', 'x', 'LineStyle', 'none');
%plot(r,m, 'Marker', 'x', 'LineStyle', 'none');
xlabel('Roost Radius');
ylabel('Reflectivity Variance from Gaussian curves');
title('Reflectivity Variance Vs. Roost Radius');
hold on;
plot(r,yfit,'r-.');



% roost_variance = [ 1.4455e+06 5.6919e+06 9.0807e+06 1.6247e+07...
%     2.6495e+07 4.0968e+07 9.3588e+07 1.9176e+08 2.8548e+08...
%     1.8419e+06 1.3505e+06 1.9928e+06 3.8846e+11...
%     1.1444e+10 2.8404e+10 2.2417e+04 1.3896e+06 2.8786e+06...
%     9.8347e+06 4.8531e+07 1.8589e+06 3.3639e+06 1.0634e+06...
%     3.2022e+06 5.6462e+06 2.1141e+07 2.5559e+11 7.6610e+10 3.7472e+06 4.6354e+06 ...
%     1.2869e+07 1.0888e+07 1.5726e+07 3.1610e+04 6.2205e+07 2.7480e+07 1.6826e+07 2.4860e+07 ...
%     2.1140e+11 2.2237e+07 6.5681e+06 1.8216e+06 6.4150e+03 3.4109e+06 5.4216e+06 7.2244e+06 ...
%     4.7721e+07 9.0477e+07 4.9706e+05 1.4821e+06 4.0401e+06 3.9709e+11 2.5456e+10 1.0390e+06 ...
%     2.5466e+06 1.0487e+08 7.7001e+07 8.8276e+07 4.7549e+05 8.6896e+06 1.7463e+06 9.8327e+05 ...
%     3.1717e+06 147.8033 4.8743e+06 1.2247e+11 8.6435e+05 1.1579e+06 1.8918e+06 2.4738e+06 ...
%     3.2011e+06 1.3989e+06 7.4731e+06 2.0344e+07 4.1833e+07 1.9419e+08 8.7040e+05 7.4217e+06 ...
%     2.9999e+07 7.6860e+07 1.2643e+08 6.6905e+04 6.2840e+06 6.3283e+10 7.4845e+05 6.9753e+06 ...
%     5.5810e+07 1.4654e+08 1.1398e+06 6.1081e+04 3.0000e+07 2.9491e+06 1.5456e+09 3.3020e+10 ...
%     8.0783e+05 1.6707e+07 1.1361e+11 2.4008e+05 2.4295e+06 1.3226e+07 2.8014e+07 2.9921e+07 ...
%     2.6322e+06 1.1111e+07 2.4079e+07 3.3277e+06 4.6612e+06 5.2967e+07 6.2370e+08 1.6231e+06 ...
%     2.9706e+06 2.1131e+07 5.5150e+07 1.4212e+09 6.6040e+06 4.4747e+07 2.9414e+08 5.0806e+11 5.6203e+05 ...
%     2.3980e+06 5.2985e+06 1.4819e+07 3.7771e+08 2.2772e+10 7.6621e+09 1.1328e+05 1.8861e+06 1.0496e+08 ...
%     1.5274e+06 4.5806e+07 1.5656e+10 2.5525e+06 2.0655e+07 5.1406e+04 2.2901e+06 1.5454e+07 8.0587e+07 ...
%     2.5070e+04 4.1133e+07 5.5163e+09 2.3795e+06 2.9534e+10 8.9643e+07 1.7033e+06 1.0950e+07 ...
%     1.8534e+07 7.1221e+07 6.3456e+06 3.3659e+11 3.1399e+03 3.1438e+06 2.5192e+07 6.5599e+05 ...
%     1.2975e+08 4.1055e+10 8.5114e+06 5.2910e+08 2.7857e+11 9.7716e+04 2.4841e+06 6.3754e+06 ...
%     1.6892e+07 4.9340e+06 2.6349e+07 3.3206e+09 134.5791 7.6793e+07 1.2145e+05 7.7942e+09 3.0920e+04 ...
%     3.7109e+06 3.66363 5.8273e+07 3.3788e+07 3.1099e+06 4.0866e+06 7.7635e+06 2.1773e+06 1.0086e+05 ...
%     4.7278e+06 2.4857e+11 1.6516e+06 4.7973e+06 7.7431e+06 1.8627e+07 2.3213e+07 3.2656e+04 1.9586e+07 ...
%     5.4553e+07 2.4234e+07 1.7511e+07 2.7449e+08 3.8721e+11 8.3315e+04 3.8376e+06 5.2357e+05 4.2465e+07 ...
%     1.8465e+08 6.7412e+11 6.0861e+05 2.4395 2.0263e+06 2.1480e+06 2.0918e+07 1.1673e+09 2.1453e+04 ...
%     5.2650e+05 2.0341e+06 1.6872e+06 5.3239 3.0572e+07 207.9783 1.2817e+06 5.1492e+06 6.7641e+06...
%     2.6916e+07 9.6550e+07 2.6718e+06 5.6748e+05 2.4316e+06 9.0528e+06 3.2082e+07 2.1326e+08 1.4822e+04 ...
%     4.1437e+05 9.7957e+05 9.1645e+05 1.9964e+06 3.5482e+06 1.0285e+07 5.7539e+07 9.0083 5.3503e+05 ...
%     1.4636e+06 1.0672e+06 3.2381e+06 5.5748e+07 2.2988e+06 1.5085e+07 1.0532e+07 1.5511e+07 2.0760e+09 ...
%     3.5051e+11 1.7137e+11 5.5005e+08 1.1214e+06 7.3834e+06 3.4566e+07 2.1967e+09 1.9758e+03 5.0577e+05 ...
%     1.8181e+06 3.4377e+07 4.3894e+07 141.5114 2.4624e+06 0.3711 1.5742e+05 9.4145 7.9314e+07 ...
%     1.4392e+06 3.9485e+06 6.7557e+07 1.7178e+08 7.4882e+10 2.1591e+06 2.1591e+06 2.0219e+06 4.4819e+06 ...
%     1.9138e+07 4.3272e+07 1.2446e+08 6.0712e+04 3.0107e+06 2.8948e+07 1.8320e+08 6.8386e+06 2.4018e+07 ...
%     1.7816e+06 7.8262e+06 1.8447e+07 6.7832e+05 2.3530e+05 2.1087e+07 5.3790e+05 2.6564e+06 1.3075e+07 ...
%     3.6397e+07 3.4084e+07 8.8108e+05 4.7744e+06 2.0778e+06 3.2594e+06 7.9112e+06 1.4804e+07 1.3977e+07 ...
%     2.9994e+06 6.6264e+06 1.3243e+07 9.3689e+05 3.1741e+04 5.6405e+05 3.7574e+06 1.7276e+06 3.8557e+06 ...
%     4.4959e+06 3.2835e+08 8.4526e+07 2.8545e+08 3.8711e+06 1.4709e+07 1.8406e+06 3.8520e+06 1.9404e+04 ...
%     1.0368e+06 1.7753e+07 3.4866 8.1488e+05 4.7882e+03 7.5360e+04 2.1887e+03 1.8416e+03];
% roost_radii = [ 3.5293e+03 8.0336e+03 1.0560e+04 1.3729e+04...
%     1.6569e+04 1.8948e+04 2.2265e+04 2.4263e+04 2.7028e+04...
%     2.4847e+03 6.7027e+03 9.5073e+03 1.1340e+04...
%     1.3737e+04 1.4932e+04 1.1197e+03 7.1138e+03 9.5485e+03...
%     1.2145e+04 1.5363e+04 3.2179e+03 6.0302e+03 2.4776e+03...
%     7.3124e+03 9.3511e+03 1.1936e+04 1.4816e+04 ...
%     1.8370e+04 2.1990e+04 2.7513e+03 4.2885e+03 6.6813e+03 9.0051e+03 1.1623e+04 2.4740e+03 4.4533e+03 ...
%     8.7120e+03 1.4533e+04 1.6333e+04 1.9548e+04 2.3382e+04 2.5976e+04 2.9317e+04 1.4684e+03 5.8993e+03 ...
%     1.0040e+04 1.2818e+04 1.5605e+04 1.6684e+04 5.2144e+03 9.1133e+03 1.1178e+04 1.4587e+04 1.7038e+04 ...
%     6.3325e+03 9.4644e+03 1.2643e+04 1.6051e+04 1.6398e+04 2.6995e+03 6.2816e+03 8.9550e+03 1.0750e+04 ...
%     1.3751e+04 1.9884e+03 4.8788e+03 9.1098e+03 2.7408e+03 6.3025e+03 8.7051e+03 1.1372e+04 11372 4.9386e+03 ...
%     1.2568e+04 1.4383e+04 1.5533e+04 1.7289e+04 4.3902e+03 8.7616e+03 1.0762e+04 1.4222e+04 1.5383e+04 4.4875e+03 ...
%     6.8198e+03 9.6729e+03 4269 8.5411e+03 1.1443e+04 1.4142e+04 3.5585e+03 5.4489e+03 6.9282e+03 2928 5.9258e+03 ...
%     7.7960e+03 2.8923e+03 8.1647e+03 1.2642e+04 3333 6.7733e+03 1.0175e+04 1.2791e+04 4311 9.1463e+03 1.3119e+04 ...
%     1.4948e+04 6.3587e+03 9.3477e+03 1.3368e+04 1.5533e+04 2.2643e+03 7.0985e+03 1.1926e+04 1.6350e+04 2.5509e+04 ...
%     8.0472e+03 1.1432e+04 1.5972e+04 2.3434e+04 2.3502e+03 6945 1.1795e+04 1.7031e+04 2.1684e+04 2.4411e+04 ...
%     2.7270e+04 1.9208e+03 6.2728e+03 9.5137e+03 4.1514e+03 8.4775e+03 1.0972e+04 4981 8.8007e+03 1.9803e+03 ...
%     5.1894e+03 8.6017e+03 1.1818e+04 3.1061e+03 6.7724e+03 1.0540e+04 5.0095e+03 1.0264e+04 1.3925e+04 2.7291e+03 ...
%     1.1764e+04 1.5895e+04 2.1650e+04 2.6489e+04 9.2052e+03 2.1121e+03 1.0665e+04 1.5235e+04 3.0683e+03 1.2792e+04 ...
%     1.7607e+04 8782 1.4883e+04 1.8141e+04 3.3833e+03 1.1177e+04 1.5227e+04 2.0213e+04 9.7932e+03 1.3391e+04 ...
%     1.7719e+04 1.5628e+03 1.0573e+04 2.2030e+03 1.0217e+04 1.2656e+03 7.7074e+03 1.3183e+04 1.5893e+04 ...
%     1.9216e+04 6326 8.5349e+03 1.2147e+04 1.5735e+04 6.6684e+03 1.0695e+04 1.3667e+04 4.6695e+03 8.8930e+03 ...
%     5.1397e+03 8.5582e+03 1.1587e+04 5.4661e+03 8.3375e+03 9.8081e+03 1.2415e+04 1.5613e+04 1.7330e+04 ...
%     1.9955e+04 3.5168e+03 4.9026e+03 6.9754e+03 9.9221e+03 1.2416e+04 1.4661e+04 1.6465e+04 2.8493e+03 ...
%     4.8543e+03 7.0762e+03 9.8666e+03 1.2099e+04 2.3216e+03 4.6746e+03 6.6552e+03 1.0038e+04 1.3336e+04 ...
%     1.5427e+04 1.8494e+03 4142 5.9186e+03 7.7603e+03 1.0338e+04 1.5520e+04 5.4862e+03 2.1054e+03 3.4267e+03 ...
%     6.8536e+03 9.2223e+03 1.1991e+04 2.1270e+03 4.1365e+03 5.0008e+03 7.3872e+03 1.0618e+04 1.2195e+04 ...
%     1.4609e+04 1.5610e+04 1.7081e+03 3.6218e+03 5.7960e+03 4050 5.4992e+03 9.1251e+03 5.5469e+03 1.0354e+04 ...
%     1.8055e+04 2.1709e+04 2.6926e+04 2.9241e+04 3.1266e+04 3.3583e+04 4.5935e+03 1.0158e+04 1.5023e+04 ...
%     1.9051e+04 1.2825e+03 6.0199e+03 8.9008e+03 1.1808e+04 1.4336e+04 3.4641e+03 6.6125e+03 8.3058e+03 ...
%     1.1376e+04 1.4506e+04 1.6917e+04 3.9685e+03 7.0731e+03 1.0800e+04 1.2530e+04 1.6594e+04 4.6117e+03 ...
%     6.3447e+03 8.3791e+03 1.0101e+04 1.3006e+04 1.4515e+04 2.0068e+03 4977 1.0150e+04 1.3190e+04 5.2914e+03 ...
%     8.2262e+03 4.7523e+03 1.0890e+04 1.3701e+04 2.7028e+03 6.7489e+03 9.5286e+03 2.7923e+03 7.9590e+03 ...
%     1.1322e+04 1.4117e+04 1.6414e+04 4270 7.2543e+03 3466 5.7480e+03 9.3905e+03 1.3420e+04 1.6352e+04 6624 ...
%     1.1787e+04 1.9593e+04 3.9103e+03 1.1645e+03 3.5396e+03 4.6824e+03 5919 4.2477e+03 5.5255e+03 2.1991e+04 ...
%     1.9847e+04 1.7482e+04 7.0200e+03 5471 7.0414e+03 8469 5.7588e+03 7.7120e+03 6.9746e+03 7.0182e+03 6.0241e+03 ...
%     1.7423e+03 3923 1.7739e+03 1.5452e+03];

    %roost_variance = roost_variance(roost_variance < 10^6);
    %roost_radii = roost_radii(roost_variance < 10^6);
    

    
% figure(1);
% plot(roost_radii,roost_variance, 'Marker', 'x', 'LineStyle', 'none');
% xlabel('Roost Radius');
% ylabel('Reflectivity Variance from Gaussian curves');
% title('Reflectivity Variance Vs. Roost Radius');
% save('roostRadiiVariance','roost_radii','roost_variance');

                
 